<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack 面试题 | 吕嘉磊的个人博客</title>
    <meta name="description" content="前端小菜鸡的进阶之路">
    <meta name="generator" content="VitePress v1.6.3">
    <link rel="preload stylesheet" href="/assets/style.lASNy4AA.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.CCJXuN7J.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.C1NWaG_K.js">
    <link rel="modulepreload" href="/assets/chunks/framework.Ds6Eueu6.js">
    <link rel="modulepreload" href="/assets/docs_interviewQuestion_Webpack面试题.md.CTq-ka6P.lean.js">
    <link rel="icon" href="/icon.svg">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-d8b57b2d><!--[--><!--]--><!--[--><span tabindex="-1" data-v-fcbfc0e0></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-fcbfc0e0>Skip to content</a><!--]--><!----><header class="VPNav" data-v-d8b57b2d data-v-7ad780c2><div class="VPNavBar" data-v-7ad780c2 data-v-9fd4d1dd><div class="wrapper" data-v-9fd4d1dd><div class="container" data-v-9fd4d1dd><div class="title" data-v-9fd4d1dd><div class="VPNavBarTitle has-sidebar" data-v-9fd4d1dd data-v-9f43907a><a class="title" href="/" data-v-9f43907a><!--[--><!--]--><!--[--><img class="VPImage logo" src="/71485393.jpeg" alt data-v-ab19afbb><!--]--><span data-v-9f43907a>吕嘉磊的个人博客</span><!--[--><!--]--></a></div></div><div class="content" data-v-9fd4d1dd><div class="content-body" data-v-9fd4d1dd><!--[--><!--]--><div class="VPNavBarSearch search" data-v-9fd4d1dd><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索文档"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">搜索文档</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-9fd4d1dd data-v-afb2845e><span id="main-nav-aria-label" class="visually-hidden" data-v-afb2845e> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>首页</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-afb2845e data-v-bfe7971f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-bfe7971f><span class="text" data-v-bfe7971f><!----><span data-v-bfe7971f>学习笔记</span><span class="vpi-chevron-down text-icon" data-v-bfe7971f></span></span></button><div class="menu" data-v-bfe7971f><div class="VPMenu" data-v-bfe7971f data-v-20ed86d6><div class="items" data-v-20ed86d6><!--[--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-7eeeb2dc><a class="VPLink link" href="/docs/notes/index" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>前端笔记</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-7eeeb2dc><a class="VPLink link" href="/docs/interviewQuestion/" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>面试题</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-7eeeb2dc><a class="VPLink link" href="/docs/vue/%E5%BC%80%E5%A7%8B" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>Vue</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-7eeeb2dc><a class="VPLink link" href="/docs/react/%E5%BC%80%E5%A7%8B" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>React</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/docs/tools/" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>工具分享</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/about" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>关于我</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-9fd4d1dd data-v-3f90c1a5><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-3f90c1a5 data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-9fd4d1dd data-v-ef6192dc data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/LvJiaLei666" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-9fd4d1dd data-v-f953d92f data-v-bfe7971f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-bfe7971f><span class="vpi-more-horizontal icon" data-v-bfe7971f></span></button><div class="menu" data-v-bfe7971f><div class="VPMenu" data-v-bfe7971f data-v-20ed86d6><!----><!--[--><!--[--><!----><div class="group" data-v-f953d92f><div class="item appearance" data-v-f953d92f><p class="label" data-v-f953d92f>Appearance</p><div class="appearance-action" data-v-f953d92f><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-f953d92f data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-f953d92f><div class="item social-links" data-v-f953d92f><div class="VPSocialLinks social-links-list" data-v-f953d92f data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/LvJiaLei666" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-9fd4d1dd data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><div class="divider" data-v-9fd4d1dd><div class="divider-line" data-v-9fd4d1dd></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-d8b57b2d data-v-2488c25a><div class="container" data-v-2488c25a><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2488c25a><span class="vpi-align-left menu-icon" data-v-2488c25a></span><span class="menu-text" data-v-2488c25a>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-2488c25a data-v-6b867909><button data-v-6b867909>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-d8b57b2d data-v-42c4c606><div class="curtain" data-v-42c4c606></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-42c4c606><span class="visually-hidden" id="sidebar-aria-label" data-v-42c4c606> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 has-active" data-v-51288d80 data-v-0009425e><!----><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/docs/interviewQuestion/JS%E9%9D%A2%E8%AF%95%E9%A2%98" data-v-0009425e><!--[--><p class="text" data-v-0009425e>JS面试题</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/docs/interviewQuestion/HTML%E9%9D%A2%E8%AF%95%E9%A2%98" data-v-0009425e><!--[--><p class="text" data-v-0009425e>HTML面试题</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/docs/interviewQuestion/Webpack%E9%9D%A2%E8%AF%95%E9%A2%98" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Webpack面试题</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/docs/interviewQuestion/%E5%AE%9E%E7%8E%B0%E5%93%8D%E5%BA%94%E5%BC%8F%E6%95%B0%E6%8D%AE+%E6%94%B6%E9%9B%86%E4%BE%9D%E8%B5%96" data-v-0009425e><!--[--><p class="text" data-v-0009425e>响应式数据实现</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/docs/interviewQuestion/Vue%E9%9D%A2%E8%AF%95%E9%A2%98" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Vue面试题</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/docs/interviewQuestion/%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF" data-v-0009425e><!--[--><p class="text" data-v-0009425e>事件循环机制</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/docs/interviewQuestion/%E6%89%8B%E5%86%99Promise" data-v-0009425e><!--[--><p class="text" data-v-0009425e>手写Promise</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/docs/interviewQuestion/%E6%89%8B%E5%86%99call%E5%92%8Capply" data-v-0009425e><!--[--><p class="text" data-v-0009425e>手写call和apply</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-d8b57b2d data-v-9a6c75ad><div class="VPDoc has-sidebar has-aside" data-v-9a6c75ad data-v-e6f2a212><!--[--><!--]--><div class="container" data-v-e6f2a212><div class="aside" data-v-e6f2a212><div class="aside-curtain" data-v-e6f2a212></div><div class="aside-container" data-v-e6f2a212><div class="aside-content" data-v-e6f2a212><div class="VPDocAside" data-v-e6f2a212 data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-cb998dce data-v-f610f197><div class="content" data-v-f610f197><div class="outline-marker" data-v-f610f197></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-f610f197>目录</div><ul class="VPDocOutlineItem root" data-v-f610f197 data-v-53c99d69><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e6f2a212><div class="content-container" data-v-e6f2a212><!--[--><!--]--><main class="main" data-v-e6f2a212><div style="position:relative;" class="vp-doc _docs_interviewQuestion_Webpack%E9%9D%A2%E8%AF%95%E9%A2%98" data-v-e6f2a212><div><h1 id="webpack-面试题" tabindex="-1">webpack 面试题 <a class="header-anchor" href="#webpack-面试题" aria-label="Permalink to &quot;webpack 面试题&quot;">​</a></h1><h2 id="_1-前端为何要进行打包和构建" tabindex="-1">1. 前端为何要进行打包和构建 <a class="header-anchor" href="#_1-前端为何要进行打包和构建" aria-label="Permalink to &quot;1. 前端为何要进行打包和构建&quot;">​</a></h2><p>代码层面：</p><ul><li>编译高级语法和特性(ES6, TS, less/sass/stylus)</li><li>体积更小，加载更快(tree-shaking, uglify, compose)</li><li>兼容性处理和错误检查(polyfill, postcss, eslint)</li></ul><p>工程化和流程层面：</p><ul><li>统一、高效的开发环境</li><li>统一的构建流程和产出标准</li><li>集成公司的构建规范(提测、上线等)</li></ul><h2 id="_2-与-webpack-类似的工具还有哪些-谈谈你为什么选择使用-webpack-或放弃-webpack" tabindex="-1">2. 与 webpack 类似的工具还有哪些？谈谈你为什么选择使用 webpack 或放弃 webpack <a class="header-anchor" href="#_2-与-webpack-类似的工具还有哪些-谈谈你为什么选择使用-webpack-或放弃-webpack" aria-label="Permalink to &quot;2. 与 webpack 类似的工具还有哪些？谈谈你为什么选择使用 webpack 或放弃 webpack&quot;">​</a></h2><p>gulp</p><ul><li>基于 nodejs 的 steam 流打包</li><li>定位是基于任务流的自动化构建工具</li><li>gulp 是通过 task 对整个开发过程进行构建</li></ul><p>gulp 优点：</p><ul><li>流式写法简单直观</li><li>API 简单，代码量少</li><li>易于学习和使用</li><li>适合多页面应用开发</li></ul><p>gulp 缺点：</p><ul><li>异常处理比较麻烦</li><li>工作流程顺序难以精细控制</li><li>不太适合单页或者自定义模块的开发</li></ul><p>webpack</p><ul><li>webpack 是模块化管理工具和打包工具。通过 loader 装换，任何形式的资源都可以视为模块，比如 CommonJS 模块、AMD 模块、ES6 模块、CSS、图片等。它可以将许多松散的模块按照依赖和打包规则打包成符合生产环境部署的前端资源</li><li>还可以将按需加载的模块进行代码分割，等到实际需要的时候再异步加载</li><li>它的定位是模块打包器，而 gulp 属于构建工具。webpack 可以代替 gulp 的一些功能，但不是一个职能的工具，可以配合使用</li></ul><p>webpack 优点：</p><ul><li>可以模块化打包任何资源</li><li>适配任何模块系统</li><li>适合单页面应用的开发</li></ul><p>webpack 缺点</p><ul><li>学习成本高，配置复杂</li><li>通过 babel 编译后的 JS 代码体积较大</li></ul><p>rollup</p><ul><li>rollup 下一代 ES6 模块化工具，最大的亮点是利用 ES6 模块设计，利用 tree-shaking 生成更简洁、更简单的代码</li></ul><p>rollup 优点</p><ul><li>用标准化的格式(ES6)来写代码，通过减少死代码尽可能地缩小包体积</li></ul><p>rollup 缺点</p><ul><li>对代码拆分、静态资源、CommonJS 模块支持并不好</li></ul><p>parcel</p><ul><li>parcel 是快速、零配置的 web 应用程序打包器</li><li>目前 parcel 只能用来构建运行在浏览器中的网页，这也是它的出发点和关注点</li></ul><p>parcel 优点</p><ul><li>parcel 内置了常见场景的构建方案及其依赖，无需安装各种依赖</li><li>parcel 能以 HTML 为入口，自动检测和打包依赖资源</li><li>parcel 默认支持模块热更新，开箱即用</li></ul><p>parcel 缺点</p><ul><li>不支持 sourceMap</li><li>不支持 tree-shaking</li><li>配置不灵活(零配置)</li></ul><h2 id="_3-loader-和-plugin-的不同" tabindex="-1">3. loader 和 plugin 的不同 <a class="header-anchor" href="#_3-loader-和-plugin-的不同" aria-label="Permalink to &quot;3. loader 和 plugin 的不同&quot;">​</a></h2><ul><li>loader 直译为加载器。webpack 将一切文件视为模块，但是 webpack 原生只能解析 js 文件，如果想将其他文件也打包的话，就会用到 loader。Loader 的作用是让 webpack 拥有了加载和解析非 javascript 文件的能力</li><li>plugin 直译为插件。plugin 可以扩展 webpack 的功能，让 webpack 具有更多的灵活性。webpack 运行的生命周期中会广播很多的事件，plugin 可以监听这些事件，在合适的时机通过 webpack 提供的 API 改变输出结果。</li></ul><p><strong>plugin 也可以在向文件目录输出文件内容时，去修改文件的内容再输出，所以某种意义上说可以实现部分 loader 的能力。但是，一般不会这样做，这并不符合 webpack 的设计理念</strong></p><h2 id="_4-自定义-loader" tabindex="-1">4. 自定义 loader <a class="header-anchor" href="#_4-自定义-loader" aria-label="Permalink to &quot;4. 自定义 loader&quot;">​</a></h2><p>loader 是一个函数，函数的参数是源码的内容，函数对源码的内容进行相应的转译，然后将转译后的内容返回。</p><p>loader 分为同步 loader 和 异步 loader</p><h2 id="_5-自定义-plugin" tabindex="-1">5. 自定义 plugin <a class="header-anchor" href="#_5-自定义-plugin" aria-label="Permalink to &quot;5. 自定义 plugin&quot;">​</a></h2><p>plugin 是一个函数或者是一个有 apply 方法的对象，函数或者 apply 方法的参数是 compiler 对象，可以用 compiler 监听各种事件，在事件的回调里实现功能</p><h2 id="_6-有哪些常见的-loader-和-plugin-它们是解决什么问题的" tabindex="-1">6. 有哪些常见的 loader 和 plugin？它们是解决什么问题的？ <a class="header-anchor" href="#_6-有哪些常见的-loader-和-plugin-它们是解决什么问题的" aria-label="Permalink to &quot;6. 有哪些常见的 loader 和 plugin？它们是解决什么问题的？&quot;">​</a></h2><p>loader</p><ul><li>babel-loader: 把 ES6 转换成 ES5</li><li>file-loader: 把文件输出到一个文件夹中，在代码中通过相对路径去引用输出的文件</li><li>url-loader: 和 file-loader 类似，但是能在文件较小的情况下以 base64 的方式注入到代码中去</li><li>style-loader: 把 css 代码通过 style 标签的形式插入到页面中</li><li>css-loader: 加载 css，支持模块化、压缩、文件导入等特性</li><li>postcss-loader: 使用 postcss 处理 css，常用来加厂商前缀</li><li>sass-loader: 把 sass/scss 文件编译成 css</li></ul><p>plugin</p><ul><li>case-sensitive-paths-webpack-plugin: 如果路径有误直接报错</li><li>terser-webpack-plugin: 使用 terser 压缩丑化代码</li><li>html-webpack-plugin: 自动生成带有入口文件的 index.html</li><li>copy-webpack-plugin: 复制不需打包的文件</li><li>optimize-css-assets-webpack-plugin: 用于优化或压缩 css 资源</li><li>mini-css-extract-plugin: 将 css 提取为单独的文件</li><li>hot-module-replacement-plugin: 启用模块热替换</li><li>define-plugin: 定义全局变量</li></ul><h2 id="_7-source-map-是什么" tabindex="-1">7. source-map 是什么？ <a class="header-anchor" href="#_7-source-map-是什么" aria-label="Permalink to &quot;7. source-map 是什么？&quot;">​</a></h2><ul><li>source-map 是为了解决开发代码和实际运行代码不一致时，帮助我们 debug 到原始代码的技术</li><li>webpack 通过配置生成 source-map 文件，map 文件是一种对应编译文件和原始文件的方法</li></ul><p>source-map 类型： 看似配置项很多，其实是五个关键字 eval、source-map、cheap、module 和 inline 的任意组合</p><ul><li>none: 不生成 .map 文件</li><li>eval: 不生成 .map 文件，可以通过 eval 函数的 sourceURL 找到对应的文件</li><li>source-map: 生成 .map 文件，可以定位代码错误的行和列</li><li>cheap: 生成 .map 文件，不包含列信息，代码报错只能定位到哪一行</li><li>module: 包含 Loader 的 source-map</li><li>inline: 不生成 .map 文件，将 .map 文件作为 dataUrl 嵌入</li></ul><h3 id="实际项目中采用哪种-source-map-呢" tabindex="-1">实际项目中采用哪种 source-map 呢？ <a class="header-anchor" href="#实际项目中采用哪种-source-map-呢" aria-label="Permalink to &quot;实际项目中采用哪种 source-map 呢？&quot;">​</a></h3><ul><li>开发环境：<strong>eval-cheap-module-source-map</strong></li></ul><p>原因：</p><ol><li>因为现在都是模块化的开发方式，所以需要调试 loader 转换前的源代码。</li><li>一般都会配置每行编写的代码不超过 80 行，所以能过定位到错误所在的行就够了。</li><li>虽然这种模式下启动打包相对会比较慢，但是使用 webpack-dev-server 都是在监视的模式下重新打包，它重新打包的速度还是很快的。</li></ol><ul><li>生产环境：<strong>none</strong></li></ul><ol><li>source-map 文件会暴露我们的源代码到生产环境，如果没有控制好 souce-map 文件的访问权限，可能被他人复现项目源码，不安全。</li><li>调试是开发阶段的事，而不应该到了生产环境，让全民去公测。</li></ol><h2 id="_8-webpack-中-hash、chunkhash、contenthash-的区别" tabindex="-1">8. webpack 中 hash、chunkhash、contenthash 的区别 <a class="header-anchor" href="#_8-webpack-中-hash、chunkhash、contenthash-的区别" aria-label="Permalink to &quot;8. webpack 中 hash、chunkhash、contenthash 的区别&quot;">​</a></h2><ul><li>hash: 是整个项目的 hash 值，其根据每次编译的内容计算得到的，每次编译后都会生成新的 hash，即修改任何文件都会导致所有文件的 hash 值跟着变化</li><li>chunkhash: chunkhash 和 hash 不一样，它根据不同的入口文件(Entry)进行依赖文件解析、构建对应的 chunk，生成对应的哈希值</li><li>contenthash: 使用 chunkhash 存在一个问题，就是当在一个 JS 文件中引入 css 文件，编译后它们的 hash 值是相同的，而且只要 js 文件发生改变，关联的 css 的 hash 也会跟着改变，这个时候可以在 mini-css-extract-plugin 里设置 contenthash，保证 css 文件所处的模块里就算其他文件内容发生改变，只要 css 文件内容不变，那么不会重构建</li></ul><h2 id="_9-webpack-的工作流程" tabindex="-1">9. webpack 的工作流程 <a class="header-anchor" href="#_9-webpack-的工作流程" aria-label="Permalink to &quot;9. webpack 的工作流程&quot;">​</a></h2><ul><li>初始化参数：把配置文件和 shell 语句中的参数合并，得到最终的参数。</li><li>开始编译：用上一步得到的参数初始化 Compiler 对象，Compiler 对象注册所有的插件，执行 Compiler 对象的 run 方法（监听模式是 watch 方法）创建 Compilation 对象（当前这次构建的上下文对象，包含了这次构建的全部资源和信息），调用 make 方法执行编译。</li><li>确定入口：根据配置中的 entry 找出所有的入口模块。</li><li>编译模块：从入口文件出发，开始依次递归出所有的依赖，形成依赖关系树，然后将递归到的每个模块交给对应的 loader 处理。</li><li>完成模块编译：在经过使用 loader 翻译完所有模块后，得到了每个模块被翻译后的最终内容以及它们之间的依赖关系。</li><li>输出资源：根据入口和模块之间的依赖关系，组装成一个个包含多个模块的 chunk，再把每个 chunk 转换成一个单独的文件加入到输出列表</li><li>输出完成：在确定好输出内容后，根据配置确定输出的路径和文件名，把文件内容写入文件系统</li></ul><h3 id="webpack-创建的-compiler-对象是如何注册插件的" tabindex="-1">webpack 创建的 compiler 对象是如何注册插件的？ <a class="header-anchor" href="#webpack-创建的-compiler-对象是如何注册插件的" aria-label="Permalink to &quot;webpack 创建的 compiler 对象是如何注册插件的？&quot;">​</a></h3><p>webpack 除了会注册用户在配置文件中声明要使用的插件外，还会根据配置的内容注册内置的插件</p><h3 id="webpack-是如何根据-entry-找出模块的所有依赖的" tabindex="-1">webpack 是如何根据 entry 找出模块的所有依赖的？ <a class="header-anchor" href="#webpack-是如何根据-entry-找出模块的所有依赖的" aria-label="Permalink to &quot;webpack 是如何根据 entry 找出模块的所有依赖的？&quot;">​</a></h3><p>webpack 是利用 acron 将文件的内容解析为 AST，但是 webpack 遍历 AST 只是根据 <code>require/import</code> 之类的导入语句，确定模块对其他资源的依赖关系，babel 才是根据 AST 对内容做转译。</p><h2 id="_10-webpack-的热更新原理" tabindex="-1">10. webpack 的热更新原理 <a class="header-anchor" href="#_10-webpack-的热更新原理" aria-label="Permalink to &quot;10. webpack 的热更新原理&quot;">​</a></h2><ul><li>使用 express 启动本地服务，让浏览器可以请求本地的静态资源</li><li>启动 websocket 服务，建立客户端和服务器之间的双向通信</li><li>webpack 监听文件的变化，执行编译</li><li>一次编译结束后，websocket 给浏览器发送通知，hash 和 ok 事件，浏览器拿到新的 hash 值，做检查更新的逻辑</li><li>利用上一次保存的 hash 值，通过 AJAX 请求 <code>hash.hot-update.json</code> 文件，获取热更新的模块及下次热更新的 hash</li><li>通过 JSONP 请求 <code>hash.hot-update.js</code> 文件</li></ul><h3 id="客户端和服务端在-hmr-里面分别是指什么-怎么实现通信的-传输的又是什么" tabindex="-1">客户端和服务端在 hmr 里面分别是指什么？怎么实现通信的？传输的又是什么？ <a class="header-anchor" href="#客户端和服务端在-hmr-里面分别是指什么-怎么实现通信的-传输的又是什么" aria-label="Permalink to &quot;客户端和服务端在 hmr 里面分别是指什么？怎么实现通信的？传输的又是什么？&quot;">​</a></h3><ul><li>客户端在 hmr 里面指的是浏览器</li><li>服务端在 hmr 里面指的是 express 服务器和 websocket 服务器</li><li>客户端和服务端的通信分为两部分，一部分是通过 express 服务器传输打包后的静态资源，另一部分是通过 websocket 通信 ok 和 hash 事件</li><li>客户端和 express 服务器之间的通信无非就是通过 AJAX 和 JSONP</li><li>客户端和 websocket 服务器之间是如何通信的呢，webpack-dev-server 在打包后的 bundle.js 里给插入了监听 websocket 的 ok 和 hash 事件的方法</li></ul><h3 id="webpack-dev-middleware-在热更新里主要做了什么" tabindex="-1">webpack-dev-middleware 在热更新里主要做了什么？ <a class="header-anchor" href="#webpack-dev-middleware-在热更新里主要做了什么" aria-label="Permalink to &quot;webpack-dev-middleware 在热更新里主要做了什么？&quot;">​</a></h3><ul><li>修改 webpack 的 fs 为 MemoryFileSystem，并将构建后的结果存储到内存中</li><li>实现请求的中间件，处理所有的资源请求，并在内存中找到对应的资源返回</li></ul><h2 id="_11-tree-shaking-机制的原理" tabindex="-1">11. tree shaking 机制的原理 <a class="header-anchor" href="#_11-tree-shaking-机制的原理" aria-label="Permalink to &quot;11. tree shaking 机制的原理&quot;">​</a></h2><ul><li>tree shaking 也叫 <code>摇树优化</code> ，通过移除多余代码来优化打包体积，生产环境下默认开启</li><li>可以在编译阶段，分析出不需要的代码</li><li>利用 ES6 模块化的规范 <ul><li>ES Module 引入静态分析，故而编译的时候可以分析出到底加载了哪些模块</li><li>在编译分析阶段，将所有的模块都放入 ModuleGraph 中，判断哪些模块和变量未被使用或者引用，进而删除对应代码</li></ul></li></ul><h2 id="_12-module-chunk-和-bundle" tabindex="-1">12. module chunk 和 bundle <a class="header-anchor" href="#_12-module-chunk-和-bundle" aria-label="Permalink to &quot;12. module chunk 和 bundle&quot;">​</a></h2><ul><li>webpack 中一切皆模块，每个文件都是一个模块</li><li>chunk 是 webppack 打包过程中 modules 的集合，它是<code>打包过程中</code>的概念，(enrty, splitChunk, runtimeChunk, import 异步加载会产生 chunk)</li><li>bundle 打包后最终输出的一个或多个文件</li></ul><h2 id="_13-chunk-和-bundle-之间的关系" tabindex="-1">13. chunk 和 bundle 之间的关系 <a class="header-anchor" href="#_13-chunk-和-bundle-之间的关系" aria-label="Permalink to &quot;13. chunk 和 bundle 之间的关系&quot;">​</a></h2><ul><li>大多数情况下一个 chunk 对应一个 bundle</li><li>如果加了 source-map ，一个 chunk 就对应两个 bundle</li><li>chunk 是打包过程中的概念，bundle 是打包完成后输出的代码块，chunk 在构建完成后就呈现为 bundle</li></ul><h2 id="_14-webpack-性能优化-构建时长" tabindex="-1">14. webpack 性能优化 - 构建时长 <a class="header-anchor" href="#_14-webpack-性能优化-构建时长" aria-label="Permalink to &quot;14. webpack 性能优化 - 构建时长&quot;">​</a></h2><ol><li><p>费时分析：使用 speed-measure-webpack-plugin</p></li><li><p>缩小范围：</p></li></ol><ul><li>如果使用 require 或者 import 导入文件时未加文件扩展名，会依次尝试添加扩展名进行匹配</li></ul><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  extensions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;.js&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;.jsx&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;.vue&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li>配置文件别名: 配置别名可以加快 webpack 查找模块的速度</li></ul><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  alias</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;@src&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;xxx&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ol start="3"><li><p>noParse: 用来指定哪些模块的文件内容不需要进行解析，比如 lodash，jquery 等库并没有第三方依赖，所以可以不用进行依赖分析</p></li><li><p>IgnorePlugin: 用于忽略某些特定的模块，让 webpack 不把这些指定的模块打包进去，比如 moment.js 中的语言包文件就不需要打包进去</p></li><li><p>利用缓存：</p></li></ol><ul><li>babel-loader 开启缓存：第一次编译完成后，第二次内容没有发生改变的不会再次编译</li><li>使用 cache-loader：在一些性能开销较大的 loader 之前添加 cache-loader，将结果缓存在磁盘中</li></ul><ol start="6"><li><p>多进程打包：把 thread-loader 放置在其他 loader 之前，放置在 thread-loader 之后的 loader 就会在一个单独的 worker 池中进行，happyPack 多进程打包。（如果打包的内容比较简单，开启多进程打包，可能还好降低打包的速度，因为开启多进程本身也会消耗一定的时间）</p></li><li><p>ParallelUglifyPlugin: 开启多进程并行压缩丑化 JS</p></li><li><p>动态链接库文件：</p></li></ol><ul><li>DllPlugin: 用于打包出一个个动态链接库</li><li>DllReferencePlugin: 在配置文件中引入 DllPlugin 插件打包好的动态链接库</li></ul><ol start="9"><li><p>自动刷新</p></li><li><p>模块热更新</p></li><li><p>利用 webpack5 的 cache 缓存</p></li></ol><p>生产环境：</p><ul><li>noParse 一些没有依赖其他库的第三方库可以不进行解析</li><li>IgnorePlugin 忽略一些不需要打包的模块</li><li>babel-loader 开启缓存</li><li>happyPack 开启多进程打包</li><li>parallelUglifyPlugin 开启多进程压缩 JS 文件</li></ul><p>开发环境：</p><ul><li>自动刷新</li><li>热更新</li><li>动态链接库文件</li></ul><h3 id="babel-loader-如何开启缓存" tabindex="-1">babel-loader 如何开启缓存 <a class="header-anchor" href="#babel-loader-如何开启缓存" aria-label="Permalink to &quot;babel-loader 如何开启缓存&quot;">​</a></h3><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// webpack.config.js</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  module: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rules: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        test:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\.</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">js</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        use: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            loader: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;babel-loader&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            options: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              cacheDirectory: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 或者是一个目录路径</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        exclude:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">node_modules</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="webpack-使用动态链接库文件的作用" tabindex="-1">webpack 使用动态链接库文件的作用 <a class="header-anchor" href="#webpack-使用动态链接库文件的作用" aria-label="Permalink to &quot;webpack 使用动态链接库文件的作用&quot;">​</a></h3><p>在使用 webpack 进行打包时，如果项目中包含大量的第三方库或模块，每次打包都需要重新编译这些模块，导致打包时间较长，并且生成的包体积很大。 打包出动态链接库文件后，只需要在依赖的版本改变后需要再次打包出新的动态链接库文件外，其他时间 webpack 只需要将项目中需要的模块和动态链接库文件链接起来，而不需要重新编译这些模块，从而减少了打包的时间，并且减小打包后的体积</p><h3 id="webpack-使用动态链接库文件的步骤" tabindex="-1">webpack 使用动态链接库文件的步骤 <a class="header-anchor" href="#webpack-使用动态链接库文件的步骤" aria-label="Permalink to &quot;webpack 使用动态链接库文件的步骤&quot;">​</a></h3><ol><li>创建一个配置文件，用于打包动态库文件</li></ol><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> path</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;path&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  entry: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    vue: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;vue&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;vue-router&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;vuex&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  output: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    filename: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;[name].dll.js&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    path: path.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(__dirname, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./dist&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    library: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;[name]_dll&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  plugins: [</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> webpack.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DllPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;[name]_dll&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      path: path.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(__dirname, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./dist/[name]-manifest.json&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ol start="2"><li>根据配置文件运行打包命令，生成动态链接库文件和对应的 manifest 文件</li><li>在 webpack 配置文件中，引用动态链接库文件</li></ol><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// webpack.config.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AddAssetHtmlPlugin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;add-asset-html-webpack-plugin&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  plugins: [</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> webpack.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DllReferencePlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      manifest: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;./dist/vue-minifest.json&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }),</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AddAssetHtmlPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      filepath: path.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(__dirname, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;dist/vue.dll.js&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>DllReferencePlugin 用于告诉 webpack 使用哪个 manifest 文件来动态加载链接库，对应的 js 文件会被拷贝到 dist 目录下。AddAssetHtmlPlugin 用于在 html 文件中自动加载链接库的 js 文件</p><h3 id="webpack5-cache-缓存的原理" tabindex="-1">webpack5 cache 缓存的原理 <a class="header-anchor" href="#webpack5-cache-缓存的原理" aria-label="Permalink to &quot;webpack5 cache 缓存的原理&quot;">​</a></h3><ol><li>其实还是使用的 cache-loader 来将构建的结果缓存在内存中，当然也可以自定缓存的类型。</li><li>使用标识符来标识模块内容是否有更改，每个模块都会分配一个标识符。</li></ol><h2 id="_15-webpack-性能优化-产出代码" tabindex="-1">15. webpack 性能优化 - 产出代码 <a class="header-anchor" href="#_15-webpack-性能优化-产出代码" aria-label="Permalink to &quot;15. webpack 性能优化 - 产出代码&quot;">​</a></h2><p>最终应达到的目的：体积更小、合理分包，不重复加载、速度更快，内存占用更小</p><ul><li>小图片 base64 格式(url-loader)</li><li>bundle 使用 contenthash(缓存)</li><li>懒加载(异步加载，webpack 的魔法注释)</li><li>抽离公共代码(splitChunks)，对 node_modules 里面的文件进行分包，特别大的第三方库使用 externals 排除</li><li>IgnorePlugin(忽略不需要打包的资源)</li><li>使用 CDN 加速(配置 publicPath)</li><li>启动 tree-shaking</li><li>使用 mini-css-extract-plugin 将 css 文件打包成单独的文件，并且丑化；使用 terser-webpack-plugin 丑化 js 代码；还可以使用 purgecss-webpack-plugin 移除没有用到的 css 代码</li><li>Scope Hosting(把所有模块合并到一起，输出到一个函数中，未开启时，一个模块就会对应一个单独的函数)</li></ul><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// tree-shaking、压缩代码、Scope Hosting 对应的配置</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  optimization: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    usedExports: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 只导出被外部引用的成员</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    minimize: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 压缩代码</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    concatenateModules: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 尽可能将所有模块合并到一起输出到一个函数中</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>使用 webpack-bundle-analyzer 插件分析打出的包的大小</strong></p><h2 id="babel-的原理" tabindex="-1">babel 的原理 <a class="header-anchor" href="#babel-的原理" aria-label="Permalink to &quot;babel 的原理&quot;">​</a></h2><p>babel 是 JavaScript 编译器，它能让开发者在开发过程中，直接使用各类方言(如 ts jsx)或新的语法特性，而不需要考虑运行环境，因为 babel 可以做到按需转换为低版本支持的代码；babel 内部原理是将 JS 代码转换为 AST，对 AST 应用各种插件进行处理，最终输出编译后的 JS 代码</p><h2 id="babel-编译流程" tabindex="-1">babel 编译流程 <a class="header-anchor" href="#babel-编译流程" aria-label="Permalink to &quot;babel 编译流程&quot;">​</a></h2><ol><li>解析阶段：babel 默认使用的是 <code>@babel/parser</code> 将代码转换为 AST。解析一般分为两个阶段：词法分析和语法分析。</li></ol><ul><li>词法分析：对输入的字符序列做标记化(tokenization)操作</li><li>语法分析：处理标记与标记之间的关系，最终形成一颗完整的 AST 结构</li></ul><ol start="2"><li><p>转换阶段：babel 使用的是 <code>@babel/traverse</code> 提供的方法对 AST 进行深度优先遍历，调用插件对关注节点的处理函数，按需对 AST 节点进行增删改操作</p></li><li><p>生成阶段：babel 默认使用的是 <code>@babel/generator</code> 将上一阶段处理后的 AST 转换为代码字符串</p></li></ol></div></div></main><footer class="VPDocFooter" data-v-e6f2a212 data-v-1bcd8184><!--[--><!--]--><div class="edit-info" data-v-1bcd8184><!----><div class="last-updated" data-v-1bcd8184><p class="VPLastUpdated" data-v-1bcd8184 data-v-1bb0c8a8>上次更新: <time datetime="2025-04-21T09:58:49.000Z" data-v-1bb0c8a8></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-1bcd8184><span class="visually-hidden" id="doc-footer-aria-label" data-v-1bcd8184>Pager</span><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link prev" href="/docs/interviewQuestion/HTML%E9%9D%A2%E8%AF%95%E9%A2%98" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>上一页</span><span class="title" data-v-1bcd8184>HTML面试题</span><!--]--></a></div><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link next" href="/docs/interviewQuestion/%E5%AE%9E%E7%8E%B0%E5%93%8D%E5%BA%94%E5%BC%8F%E6%95%B0%E6%8D%AE+%E6%94%B6%E9%9B%86%E4%BE%9D%E8%B5%96" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>下一页</span><span class="title" data-v-1bcd8184>响应式数据实现</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-d8b57b2d data-v-566314d4><div class="container" data-v-566314d4><p class="message" data-v-566314d4>用心记录，用力成长</p><p class="copyright" data-v-566314d4>Copyright © 2023-present 吕嘉磊</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"about.md\":\"BNjnwa1n\",\"docs_interviewquestion_html面试题.md\":\"DIae5eyk\",\"docs_interviewquestion_index.md\":\"BAPGwCh7\",\"docs_interviewquestion_js面试题.md\":\"BdXrIyPZ\",\"docs_interviewquestion_vue面试题.md\":\"Sq2LNq4s\",\"docs_interviewquestion_webpack面试题.md\":\"CTq-ka6P\",\"docs_interviewquestion_事件循环.md\":\"K9W6J4Cw\",\"docs_interviewquestion_实现响应式数据_收集依赖.md\":\"CgEjVD0v\",\"docs_interviewquestion_手写call和apply.md\":\"ByiuXluT\",\"docs_interviewquestion_手写promise.md\":\"BptRoRO-\",\"docs_notes_githubpages.md\":\"rUbZBtXL\",\"docs_notes_index.md\":\"DIyohOsd\",\"docs_notes_micro-app.md\":\"Dcw4cBcT\",\"docs_notes_patch-package.md\":\"C6X8nJ8X\",\"docs_notes_practice.md\":\"DsO94h36\",\"docs_notes_puppeteer.md\":\"DfVnsKyW\",\"docs_notes_verdaccio.md\":\"DXweYKN3\",\"docs_notes_webpack5update.md\":\"Tmsx0BMK\",\"docs_react_开始.md\":\"CRnqsLS9\",\"docs_tomyself.md\":\"dIjUnJ9u\",\"docs_vue_vue3.md\":\"CQ61dQQS\",\"docs_vue_实现一个mini-vue2.md\":\"JdXU2Xfw\",\"docs_vue_开始.md\":\"k5YBoPo0\",\"index.md\":\"BUKw3tdP\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"吕嘉磊的个人博客\",\"description\":\"前端小菜鸡的进阶之路\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"/71485393.jpeg\",\"nav\":[{\"text\":\"首页\",\"link\":\"/\"},{\"text\":\"学习笔记\",\"items\":[{\"text\":\"前端笔记\",\"link\":\"/docs/notes/index\"},{\"text\":\"面试题\",\"link\":\"/docs/interviewQuestion/\"},{\"text\":\"Vue\",\"link\":\"/docs/vue/开始\"},{\"text\":\"React\",\"link\":\"/docs/react/开始\"}]},{\"text\":\"工具分享\",\"link\":\"/docs/tools/\"},{\"text\":\"关于我\",\"link\":\"/about\"}],\"sidebar\":{\"/docs/interviewQuestion/\":[{\"text\":\"JS面试题\",\"link\":\"/docs/interviewQuestion/JS面试题\"},{\"text\":\"HTML面试题\",\"link\":\"/docs/interviewQuestion/HTML面试题\"},{\"text\":\"Webpack面试题\",\"link\":\"/docs/interviewQuestion/Webpack面试题\"},{\"text\":\"响应式数据实现\",\"link\":\"/docs/interviewQuestion/实现响应式数据+收集依赖\"},{\"text\":\"Vue面试题\",\"link\":\"/docs/interviewQuestion/Vue面试题\"},{\"text\":\"事件循环机制\",\"link\":\"/docs/interviewQuestion/事件循环\"},{\"text\":\"手写Promise\",\"link\":\"/docs/interviewQuestion/手写Promise\"},{\"text\":\"手写call和apply\",\"link\":\"/docs/interviewQuestion/手写call和apply\"}],\"/docs/vue/\":[{\"text\":\"Vue 深入浅出\",\"collapsed\":false,\"items\":[{\"text\":\"基础入门\",\"link\":\"/docs/vue/开始\"},{\"text\":\"实现一个mini-vue2\",\"link\":\"/docs/vue/实现一个mini-vue2\"}]}],\"/docs/react/\":[{\"text\":\"React 学习笔记\",\"collapsed\":false,\"items\":[{\"text\":\"快速上手\",\"link\":\"/docs/react/开始\"}]}],\"/docs/notes/\":[{\"text\":\"实用笔记\",\"collapsed\":false,\"items\":[{\"text\":\"GitHub Pages 部署\",\"link\":\"/docs/notes/githubPages\"},{\"text\":\"私有 NPM 仓库\",\"link\":\"/docs/notes/verdaccio\"},{\"text\":\"Webpack5 配置\",\"link\":\"/docs/notes/webpack5Update\"},{\"text\":\"实战练习\",\"link\":\"/docs/notes/practice\"},{\"text\":\"Patch Package\",\"link\":\"/docs/notes/patch-package\"},{\"text\":\"micro-app\",\"link\":\"/docs/notes/micro-app\"},{\"text\":\"puppeteer\",\"link\":\"/docs/notes/puppeteer\"}]}]},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/LvJiaLei666\"}],\"footer\":{\"message\":\"用心记录，用力成长\",\"copyright\":\"Copyright © 2023-present 吕嘉磊\"},\"search\":{\"provider\":\"local\",\"options\":{\"translations\":{\"button\":{\"buttonText\":\"搜索文档\",\"buttonAriaLabel\":\"搜索文档\"},\"modal\":{\"noResultsText\":\"无法找到相关结果\",\"resetButtonTitle\":\"清除查询条件\",\"footer\":{\"selectText\":\"选择\",\"navigateText\":\"切换\"}}}}},\"lastUpdated\":{\"text\":\"上次更新\",\"formatOptions\":{\"dateStyle\":\"full\",\"timeStyle\":\"medium\"}},\"docFooter\":{\"prev\":\"上一页\",\"next\":\"下一页\"},\"outline\":{\"level\":[2,3],\"label\":\"目录\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>